---
title: 内存泄漏
date: 2023-11-21
tags:
---
# 内存泄漏

## 什么是内存泄漏?

> 内存泄漏 是应用程序过去使用，但不再需要的尚未返回到操作系统或可用内存池的内存片段。由于没有被释放而导致的，它将可能引起程序的卡顿和崩溃。

## JavaScript 常见的四种内存泄漏

* 1：全局变量
* 2：被忘记的定时器或者回调函数
* 3：闭包
* 4: DOM 的过度引用


以 Vue 为例，通常有这些情况：

* 监听在 window/body 等事件没有解绑
* 绑在 EventBus 的事件没有解绑
* Vuex 的 $store，watch 了之后没有 unwatch
* 使用第三方库创建，没有调用正确的销毁函数

解决办法：beforeDestroy 中及时销毁

* 绑定了 DOM/BOM 对象中的事件 addEventListener ，removeEventListener。
* 观察者模式 $on，$off处理。
* 如果组件中使用了定时器，应销毁处理。
* 如果在 mounted/created 钩子中使用了第三方库初始化，对应的销毁。
* 使用弱引用 weakMap、weakSet。


##  浏览器中不同类型变量的内存都是何时释放的？

* 引用类型
  * 在没有引用之后，通过 V8 自动回收。
* 基本类型
  * 如果处于闭包的情况下，要等闭包没有引用才会被 V8 回收。
  * 非闭包的情况下，等待 V8 的新生代切换的时候回收。


[[译] JavaScript如何工作：垃圾回收机制 + 常见的4种内存泄漏](https://juejin.cn/post/6844903810825994253)








