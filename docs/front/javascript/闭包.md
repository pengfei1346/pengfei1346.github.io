---
isTimeLine: true
title: 闭包
date: 2021-11-21
tags:
- js基础
---
# 闭包


## 什么是闭包？

> 就是函数引用了外部作用域的变量

**闭包常见的两种情况：**
一是函数作为返回值； 另一个是函数作为参数传递

**闭包的作用：**
可以让局部变量的值始终保持在内存中；对内部变量进行保护，使外部访问不到
最常见的案例：函数节流和防抖

**闭包的垃圾回收：**
副作用：不合理的使用闭包，会造成内存泄露(就是该内存空间使用完毕之后未被回收)
闭包中引用的变量直到闭包被销毁时才会被垃圾回收

**示例：**

```js
// 原始题目
for (var i = 0; i < 5; i++) {
  setTimeout(function() {
    console.log(i); // 1s后打印出5个5
  }, 1000);
}

// ⬅️利用闭包，将上述题目改成1s后，打印0,1,2,3,4

// 方法一：
for (var i = 0; i < 5; i++) {
  (function(j) {
    setTimeout(function timer() {
      console.log(j);
    }, 1000);
  })(i);
}

// 方法二：
// 利用setTimeout的第三个参数，第三个参数将作为setTimeout第一个参数的参数
for (var i = 0; i < 5; i++) {
  setTimeout(function fn(i) {
    console.log(i);
  }, 1000, i); // 第三个参数i,将作为fn的参数
}

// ⬅️将上述题目改成每间隔1s后，依次打印0,1,2,3,4
for (var i = 0; i < 5; i++) {
  setTimeout(function fn(i) {
    console.log(i);
  }, 1000 * i, i);
}

```


















